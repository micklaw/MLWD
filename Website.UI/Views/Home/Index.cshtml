@using Website.Domain.Home.Models.Archetypes
@using System.Linq
@using Yomego.Umbraco.Mvc.Model.Media
@model Website.Domain.Home.ViewModels.HomeViewModel
@{
    var testimonials = (Model.Content.Testimonials ?? new List<Testimonial>()).Where(i => !i.Disabled).ToList();
    var services = (Model.Content.Services ?? new List<Service>()).Where(i => !i.Disabled).ToList();

    var hasImage = false;
    string imageUrl = null;
    
    if (Model.Content.HeaderBackground != null && Model.Content.HeaderBackground.HasUrl)
    {
        hasImage = true;
        imageUrl = Model.Content.HeaderBackground.GetCrop(1920, 900);
    }
}

<section id="home-parallax" class="parallax" @Html.Attr("style", hasImage, string.Format("background: url('{0}') no-repeat;", imageUrl))>
    <div class="container text-center">
        <h2 class="wow animated fadeInDown"><span class="colored-text">Hello!</span></h2>
        <p class="lead animated fadeIn">
            @ViewBag.MetaDescription
        </p>
    </div>
</section>

@if (services.Any())
{
    <!--things im good at-->
    <section class="services-wrap">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="center-heading">
                        <h2>Services</h2>
                        <span class="center-line"></span>
                    </div>
                </div>
            </div>
            <!--center heading row-->
            @Html.Partial("Services", services)
        </div>
    </section>
}

@if (Model.Work != null && Model.Work.Any())
{
    <!--recent work-->
    <div class="divide40"></div>
    <section class="portfolio">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="center-heading">
                        <h2>Recent work</h2>
                        <span class="center-line"></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div id="work-carousel" class="owl-carousel owl-spaced">
                        @foreach (var work in Model.Work)
                        {
                            <div>
                                <div class="item-img-wrap ">
                                    @Html.FluidImage(work.BlogImage, 370, 247)
                                    <div class="item-img-overlay">
                                        <a href="@work.Url" class="show-image">
                                            <span></span>
                                        </a>
                                    </div>
                                </div>
                                <!--item img wrap-->
                                <div class="work-desc">
                                    <h3><a href="@work.Url">@work.WorkTitle</a></h3>
                                    <span>@work.WorkClient</span>
                                </div>
                                <!--work desc-->
                            </div>
                        }
                    </div>
                </div>
            </div>
            <div class="divide30"></div>
            <div class="row">
                <div class="col-md-12 text-center">
                    <a href="@Urls.Blog?c=work" class="btn border-theme btn-lg wow animated fadeInUp"><i class="fa fa-bars"></i>More of my work</a>
                </div>
            </div>
        </div>
        <!--container-->
    </section>
    <!--recent work-->
}

@if (testimonials.Any())
{
    <!--testimonials-->
    <section class="testimonials">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="center-heading">
                        <h2>Feedback</h2>
                        <span class="center-line"></span>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 col-md-offset-2 text-center">
                    <div id="testi-carousel" class="owl-carousel owl-spaced">
                        @foreach (var testimonial in testimonials)
                        {
                            <div>
                                @Html.FluidImage(testimonial.Image, 100, 100, htmlAttributes: new { @class = "img-responsive customer-img"})
                                <h4>
                                    <i class="fa fa-quote-left"></i>&nbsp;@testimonial.Quote&nbsp;<i class="fa fa-quote-right"></i>
                                </h4>
                                <p>-@testimonial.Person</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--testimonials-->
}

@if (Model.Blogs != null && Model.Blogs.Any())
{
    <!--blog-->
    <div class="divide80"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-12 margin40">
                <div class="center-heading">
                    <h2>Latest Blogs</h2>
                    <span class="center-line"></span>
                </div>
                <div id="news-carousel" class="owl-carousel owl-spaced">
                    @foreach (var blog in Model.Blogs)
                    {
                        <div>
                            <a href="@blog.Url">
                                <div class="item-img-wrap">
                                    @Html.FluidImage(blog.BlogImage, 500, 300)
                                    <div class="item-img-overlay">
                                        <span></span>
                                    </div>
                                </div>
                            </a>
                            <!--news link-->
                            <div class="news-desc">
                                <span>@blog.BlogCategory</span>
                                <h4><a href="@blog.Url">@blog.BlogTitle</a></h4>
                                <span>@Html.ToDate(blog.BlogPublishDate)</span> <span><a href="@blog.Url">Read more...</a></span>
                            </div>
                            <!--news desc-->
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
    <!--blog-->
}